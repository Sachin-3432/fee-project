<html>

<head>
    <title>
        Document.
    </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script>
        function doPrev(refFile, prevImg) {
            const [file] = refFile.files
            if (file) {
                prevImg.src = URL.createObjectURL(file)
            }
        }
        $(document).ready(function () {
            $("#btnSearch").click(function () {
                var myKuchEmail = $("#txtEmail").val();

                var obj = {
                    type: "get",
                    url: "/json-get-record",
                    data: {
                        kuchEmail: myKuchEmail,
                    }
                }

                $.ajax(obj).done(function (respJsonAry) {
                    alert(JSON.stringify(respJsonAry));

                    if (respJsonAry.length == 0)
                        alert("Invalid ID");
                    else {
                        $("#txtPassword").val(respJsonAry[0].password);
                        alert(respJsonAry[0].dos);
                        $("#dos").val(respJsonAry[0].dos);
                        // alert(respJsonAry[0].pname);

                        $("#hdn").val(respJsonAry[0].pic);
                        $("#prev").prop("src", "uploads/" + respJsonAry[0].pic);
                    }
                }).fail(function (kuchErr) {
                    alert(kuchErr.toString());
                });
            })
        })

    </script>

    <style>
        #waiting {
            width: 200px;
            height: 40px;
            background-image: url(ppics/spinning-arrows.gif);
            background-size: contain;
            background-repeat: no-repeat;
            display: none;
        }
    </style>
</head>

<body bgcolor="orangered">
    <center>
        <h2><u><i>Signup-Here</i></u></h2>
        <div class="container">
            <div class="row">
                <form method="post" enctype="multipart/form-data">
                    <input type="hidden" id="hdn" name="hdn">
                    <div class="col-md-8 offset-md-2">
                        <div class="form-floating mb-3">
                            <input type="email" class="form-control" name="txtEmail" id="txtEmail" value=" ">
                            <label for="floatingInput">Email-Address</label>
                        </div>
                        <p>
                            <input type="button" class="btn btn-outline-success" value="Search" id="btnSearch">
                        </p>

                        <div class="form-floating mb-3">
                            <input type="password" class="form-control" name="txtPassword" id="txtPassword" value="">
                            <label for="floatingPassword">Password</label>
                        </div>
                        <div class="form-floating mb-3">
                            <input type="date" class="form-control" name="dos" id="dos" value="">
                            <label for="floatingInput">Date of Sign-Up</label>
                        </div>
                        <div id="waiting"></div>
                        <p>
                            <span>
                                <h2 id="result"></h2>
                            </span>
                        </p>
                        <div>
                            Upload your Profile Picture:-
                            <br>
                            <br>
                            <input type="file" name="profilePic" id="ppic" onchange="doPrev(ppic,prev);">
                        </div>
                        <p>
                            <br>
                            <br>
                            <img id="prev" height="150" width="150">
                        </p>

                        <center>
                            <input type="submit" value="Signup-Here" class="btn btn-outline-warning mt-5"
                                formaction="/signup-process-db">
                            <input type="submit" value="Delete User Profile" class="btn btn-outline-danger mt-5"
                                formaction="/delete-process-db">
                            <input type="submit" value="Update User Profile" class="btn btn-outline-secondary mt-5"
                                formaction="/update-process-db">
                            <input type="submit" value="Show All User Profiles" class="btn btn-outline-primary mt-5"
                                formaction="/showall-process-db">
                        </center>
                    </div>
                </form>
            </div>
        </div>
    </center>
</body>

</html>